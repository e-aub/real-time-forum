<!DOCTYPE html>
<html>
  <head>
    <title>Talk</title>
    <link rel="stylesheet" href="/static/styles/style.css">
    <link rel="icon" href="/static/images/logo.png" type="image/png">
</head>

  <body>
    <div id="app"></div>
    <!-- <form onsubmit="sendMessage(event)">
      <label for="message">Message</label>
      <input type="text" id="message" placeholder="what's in your mind?" />
      <button type="submit">SEND</button>
    </form> -->
    <script src="/static/scripts/router.js" type="module"></script>
    <!-- SI YASSINE script-->
    <!-- <script>
      // const socket = new WebSocket("ws://localhost:8000/api/ws");
      // socket.addEventListener("open", (e) => {
      //   console.log("Connection opened");
      // });

      // function sendMessage(event) {
      //   event.preventDefault();
      //   const message = document.querySelector("#message");
      //   if (socket.readyState === WebSocket.OPEN) {
      //     const date = new Date()
      //       const data = {
      //           sender: "yassinerahhaui",
      //           receiver: "Yrahhaoui1234",
      //           message: message.value,
      //           creationDate: date.toString()
      //       }
      //     socket.send(JSON.stringify(data))
      //     console.log(data);
          
      //     message.value = "";
      //   } else {
      //     console.error("WebSocket is not open. Ready state: " + socket.readyState);
      //   }
      // }

      // // Listen for messages
      // socket.addEventListener("message", (event) => {
      //   data = JSON.parse(event.data)
      //   console.log(`Message from ${data.sender}`,data );
      // });

    </script> -->
    
    <!-- AYOUB script-->
    <!-- <script>
         const ws = new WebSocket("ws://localhost:8000/api/ws");

document.addEventListener("DOMContentLoaded", () => {
    const messagesDiv = document.createElement("div");
    messagesDiv.id = "messages";
    document.body.appendChild(messagesDiv);
});

const appendMessage = (message) => {
    const messagesDiv = document.getElementById("messages");
    const messageElement = document.createElement("p");
    messageElement.textContent = message;
    messagesDiv.appendChild(messageElement);
};

ws.onopen = () => {
    console.log("Connected to WebSocket server");
    appendMessage("Connected to WebSocket server");

    // Send a test message every 2 seconds
    setInterval(() => {
        const testMessage = {
            type: "message",
            receiver: "eaub",
            message: "Hello, this is a test!",
            creation_date: new Date().toISOString(),
        };

        ws.send(JSON.stringify(testMessage));
        console.log("Sent message:", testMessage);
        appendMessage(`Sent: ${testMessage.message}`);
    }, 2000);
};

ws.onmessage = (event) => {
    try {
        const data = JSON.parse(event.data);
        
        if (data.type === "status") {
            console.log(`User: ${data.user_name}, Online: ${data.online}`);
            appendMessage(`User: ${data.user_name}, Online: ${data.online}`);
        } else if (data.type === "message") {
            console.log(`Message from ${data.sender}: ${data.message}`);
            appendMessage(`From ${data.sender}: ${data.message}`);
        } else {
            console.log("Received:", data);
            appendMessage(`Received: ${JSON.stringify(data)}`);
        }
    } catch (error) {
        console.error("Error parsing message:", error);
        appendMessage("Error parsing message");
    }
};

// Handle receiving messages from a user
const receiveMessage = (data) => {
    if (data.type === "message") {
        console.log(`New message from ${data.sender}: ${data.message}`);
        appendMessage(`New message from ${data.sender}: ${data.message}`);
    }
};

ws.onclose = () => {
    console.log("Disconnected from WebSocket server");
    appendMessage("Disconnected from WebSocket server");
};

ws.onerror = (error) => {
    console.error("WebSocket error:", error);
    appendMessage("WebSocket error");
};

// Prevent form submission from reloading the page
document.addEventListener("submit", (event) => {
    event.preventDefault();
});
    </script> -->
  </body>
</html>


